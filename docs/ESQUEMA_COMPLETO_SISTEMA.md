# üéì ESQUEMA COMPLETO DEL SISTEMA MINDSCHOOL

## üìã √çNDICE

1. [Arquitectura General](#arquitectura-general)
2. [Modelos de Datos](#modelos-de-datos)
3. [Flujos de Usuario](#flujos-de-usuario)
4. [API y Endpoints](#api-y-endpoints)
5. [Frontend y Componentes](#frontend-y-componentes)
6. [Seguridad y Autenticaci√≥n](#seguridad-y-autenticaci√≥n)
7. [Diagrama de Flujo](#diagrama-de-flujo)

---

## üèóÔ∏è ARQUITECTURA GENERAL

### Stack Tecnol√≥gico

```
Backend: Laravel 11 + PHP 8.2 + MySQL + MongoDB
Frontend: React 18 + Vite + Axios
Autenticaci√≥n: Laravel Sanctum
Base de Datos: MySQL (principal) + MongoDB (multimedia)
```

### Estructura del Proyecto

```
miprojecto_mindschool/
‚îú‚îÄ‚îÄ mindschool/                 # Backend Laravel
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Models/            # Modelos de datos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Http/Controllers/  # Controladores API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Traits/           # Traits compartidos
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ migrations/       # Migraciones BD
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ seeders/         # Datos iniciales
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.php          # Rutas API
‚îÇ   ‚îî‚îÄ‚îÄ tests/               # Tests autom√°ticos
‚îî‚îÄ‚îÄ frontend/                # Frontend React
    ‚îú‚îÄ‚îÄ src/
    ‚îÇ   ‚îú‚îÄ‚îÄ componentes/     # Componentes reutilizables
    ‚îÇ   ‚îú‚îÄ‚îÄ paginas/        # P√°ginas principales
    ‚îÇ   ‚îú‚îÄ‚îÄ contexto/       # Context API
    ‚îÇ   ‚îú‚îÄ‚îÄ hooks/          # Custom hooks
    ‚îÇ   ‚îî‚îÄ‚îÄ branding/       # Sistema de dise√±o
    ‚îî‚îÄ‚îÄ public/             # Assets est√°ticos
```

---

## üóÑÔ∏è MODELOS DE DATOS

### 1. Usuario (User)

```php
// Roles: admin, profesor, estudiante
// Relaciones principales:
- inscripciones() ‚Üí Inscripcion[]
- entregasTareas() ‚Üí EntregaTarea[]
- cursosInstructor() ‚Üí Curso[]
```

### 2. Curso

```php
// Campos: titulo, descripcion, duracion, nivel, precio, estado, instructor_id, imagen_url
// Relaciones:
- instructor() ‚Üí User
- inscripciones() ‚Üí Inscripcion[]
- tareas() ‚Üí Tarea[]
- lecciones() ‚Üí Leccion[]
```

### 3. Inscripci√≥n

```php
// Campos: user_id, curso_id, estado, fecha_inscripcion, progreso
// Relaciones:
- alumno() ‚Üí User
- curso() ‚Üí Curso
```

### 4. Lecci√≥n

```php
// Campos: titulo, descripcion, contenido, duracion, orden, curso_id, estado
// Relaciones:
- curso() ‚Üí Curso
- multimedia() ‚Üí Multimedia[]
```

### 5. Tarea

```php
// Campos: titulo, descripcion, fecha_asignacion, fecha_entrega, tipo, archivo_url, curso_id, leccion_id, estado, puntos_maximos
// Relaciones:
- curso() ‚Üí Curso
- leccion() ‚Üí Leccion
- entregas() ‚Üí EntregaTarea[]
```

### 6. Entrega de Tarea

```php
// Campos: tarea_id, estudiante_id, archivo_url, comentarios, calificacion, comentarios_profesor, fecha_entrega, estado
// Relaciones:
- tarea() ‚Üí Tarea
- estudiante() ‚Üí User
```

### 7. Multimedia

```php
// Campos: titulo, descripcion, tipo, url, leccion_id, orden, estado
// Relaciones:
- leccion() ‚Üí Leccion
```

### 8. Mensaje

```php
// Campos: remitente_id, destinatario_id, asunto, contenido, tipo, estado, fecha_envio, fecha_lectura
```

---

## üîÑ FLUJOS DE USUARIO

### 1. Flujo de Autenticaci√≥n

```
1. Usuario accede a /login
2. Ingresa credenciales
3. Backend valida y genera token Sanctum
4. Frontend almacena token en localStorage
5. Redirecci√≥n seg√∫n rol:
   - admin ‚Üí /admin/dashboard
   - profesor ‚Üí /profesor/dashboard
   - estudiante ‚Üí /estudiante/dashboard
```

### 2. Flujo de Profesor

```
1. Login como profesor
2. Accede al panel de profesor
3. Selecciona cuatrimestre
4. Ve materias asignadas
5. Selecciona materia
6. Ve grupos de alumnos
7. Gestiona tareas y calificaciones
8. Monitorea progreso de estudiantes
```

### 3. Flujo de Estudiante

```
1. Login como estudiante
2. Ve dashboard con tareas pendientes
3. Navega por materias inscritas
4. Accede a lecciones y contenido multimedia
5. Entrega tareas
6. Ve calificaciones y progreso
```

### 4. Flujo de Administrador

```
1. Login como admin
2. Gestiona usuarios y roles
3. Administra cursos y materias
4. Monitorea inscripciones
5. Genera reportes y estad√≠sticas
```

---

## üåê API Y ENDPOINTS

### Autenticaci√≥n

```
POST /api/register     - Registro de usuario
POST /api/login        - Inicio de sesi√≥n
POST /api/logout       - Cerrar sesi√≥n
GET  /api/user         - Obtener usuario actual
```

### Cursos (Protegido)

```
GET    /api/cursos              - Listar cursos
POST   /api/cursos              - Crear curso
GET    /api/cursos/{id}         - Ver curso espec√≠fico
PUT    /api/cursos/{id}         - Actualizar curso
DELETE /api/cursos/{id}         - Eliminar curso
```

### Profesor (Protegido)

```
GET /api/profesor/dashboard           - Dashboard del profesor
GET /api/profesor/cursos              - Cursos del profesor
GET /api/profesor/cursos/{id}/estudiantes - Estudiantes del curso
GET /api/profesor/cursos/{id}/lecciones   - Lecciones del curso
POST /api/profesor/lecciones          - Crear lecci√≥n
PUT /api/inscripciones/{id}/progreso  - Actualizar progreso
GET /api/profesor/cursos/{id}/estadisticas - Estad√≠sticas del curso
```

### Estudiante (Protegido)

```
GET /api/estudiante/dashboard      - Dashboard del estudiante
GET /api/estudiante/materias       - Materias del estudiante
GET /api/estudiante/tareas-pendientes - Tareas pendientes
GET /api/estudiante/tareas/{id}    - Detalle de tarea
POST /api/estudiante/tareas/{id}/entregar - Entregar tarea
GET /api/estudiante/calificaciones - Calificaciones
GET /api/estudiante/perfil         - Perfil del estudiante
PUT /api/estudiante/perfil         - Actualizar perfil
```

### Inscripciones (Protegido)

```
GET    /api/inscripciones              - Listar inscripciones
POST   /api/inscripciones              - Crear inscripci√≥n
GET    /api/inscripciones/{id}         - Ver inscripci√≥n
PUT    /api/inscripciones/{id}         - Actualizar inscripci√≥n
DELETE /api/inscripciones/{id}         - Eliminar inscripci√≥n
GET    /api/cursos/{id}/inscripciones  - Inscripciones de un curso
```

---

## üé® FRONTEND Y COMPONENTES

### Estructura de Componentes

```
src/
‚îú‚îÄ‚îÄ componentes/
‚îÇ   ‚îú‚îÄ‚îÄ Navbar.jsx              # Barra de navegaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ LoadingSpinner.jsx      # Spinner de carga
‚îÇ   ‚îú‚îÄ‚îÄ RedireccionPorRol.jsx   # Redirecci√≥n por rol
‚îÇ   ‚îî‚îÄ‚îÄ profesor/               # Componentes espec√≠ficos de profesor
‚îÇ       ‚îú‚îÄ‚îÄ CuatrimestreSelector.jsx
‚îÇ       ‚îú‚îÄ‚îÄ MateriasGrid.jsx
‚îÇ       ‚îú‚îÄ‚îÄ GruposMenu.jsx
‚îÇ       ‚îú‚îÄ‚îÄ GrupoDetalle.jsx
‚îÇ       ‚îú‚îÄ‚îÄ TareaModal.jsx
‚îÇ       ‚îú‚îÄ‚îÄ CalificarModal.jsx
‚îÇ       ‚îî‚îÄ‚îÄ DetalleTareaModal.jsx
‚îú‚îÄ‚îÄ paginas/
‚îÇ   ‚îú‚îÄ‚îÄ Login.jsx               # P√°gina de login
‚îÇ   ‚îú‚îÄ‚îÄ AdminDashboard.jsx      # Dashboard de admin
‚îÇ   ‚îú‚îÄ‚îÄ ProfesorDashboard.jsx   # Dashboard de profesor
‚îÇ   ‚îú‚îÄ‚îÄ ProfesorPanel.jsx       # Panel principal de profesor
‚îÇ   ‚îú‚îÄ‚îÄ EstudianteDashboard.jsx # Dashboard de estudiante
‚îÇ   ‚îî‚îÄ‚îÄ EstudiantePanel.jsx     # Panel principal de estudiante
‚îú‚îÄ‚îÄ contexto/
‚îÇ   ‚îî‚îÄ‚îÄ AuthContext.jsx         # Contexto de autenticaci√≥n
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îî‚îÄ‚îÄ useApi.js               # Hook para llamadas API
‚îú‚îÄ‚îÄ branding/
‚îÇ   ‚îú‚îÄ‚îÄ branding.js             # Variables de dise√±o
‚îÇ   ‚îú‚îÄ‚îÄ Logo.jsx                # Componente del logo
‚îÇ   ‚îî‚îÄ‚îÄ Mascota.jsx             # Componente de mascota animada
‚îî‚îÄ‚îÄ config/
    ‚îî‚îÄ‚îÄ environment.js          # Configuraci√≥n de entorno
```

### Sistema de Dise√±o

```javascript
// Colores principales
COLORS = {
  primary: "#3B82F6", // Azul principal
  secondary: "#1E40AF", // Azul oscuro
  background: "#0F172A", // Fondo oscuro
  surface: "#1E293B", // Superficie
  text: "#F8FAFC", // Texto claro
  textSecondary: "#94A3B8", // Texto secundario
  border: "#334155", // Bordes
  success: "#10B981", // Verde √©xito
  warning: "#F59E0B", // Amarillo advertencia
  error: "#EF4444", // Rojo error
};
```

---

## üîí SEGURIDAD Y AUTENTICACI√ìN

### Middleware de Protecci√≥n

```php
// Rutas protegidas por autenticaci√≥n
Route::middleware('auth:sanctum')->group(function () {
    // Todas las rutas que requieren login
});

// Verificaci√≥n de roles en frontend
<RutaConRol rolesPermitidos={['profesor']}>
    <ProfesorDashboard />
</RutaConRol>
```

### Sistema de Roles

- **admin**: Acceso completo al sistema
- **profesor**: Gesti√≥n de cursos y estudiantes
- **estudiante**: Acceso a materias y tareas

### Validaci√≥n de Datos

- Validaci√≥n en backend con Laravel Validation
- Sanitizaci√≥n de inputs
- Protecci√≥n CSRF
- Rate limiting en endpoints cr√≠ticos

---

## üìä DIAGRAMA DE FLUJO

```mermaid
graph TD
    A[Usuario accede al sistema] --> B{¬øEst√° autenticado?}
    B -->|No| C[P√°gina de Login]
    B -->|S√≠| D[Verificar rol]

    C --> E[Ingresar credenciales]
    E --> F{¬øCredenciales v√°lidas?}
    F -->|No| C
    F -->|S√≠| G[Generar token Sanctum]
    G --> D

    D --> H{¬øQu√© rol?}

    H -->|Admin| I[Admin Dashboard]
    H -->|Profesor| J[Profesor Dashboard]
    H -->|Estudiante| K[Estudiante Dashboard]

    I --> L[Gesti√≥n de Usuarios]
    I --> M[Gesti√≥n de Cursos]
    I --> N[Reportes y Estad√≠sticas]

    J --> O[Seleccionar Cuatrimestre]
    O --> P[Ver Materias]
    P --> Q[Seleccionar Materia]
    Q --> R[Ver Grupos]
    R --> S[Gestionar Tareas]
    R --> T[Calificar Estudiantes]
    R --> U[Monitorear Progreso]

    K --> V[Ver Tareas Pendientes]
    K --> W[Acceder a Materias]
    W --> X[Ver Lecciones]
    X --> Y[Consumir Multimedia]
    V --> Z[Entregar Tareas]
    Z --> AA[Ver Calificaciones]

    L --> BB[Crear/Editar Usuarios]
    L --> CC[Asignar Roles]
    M --> DD[Crear/Editar Cursos]
    M --> EE[Gestionar Inscripciones]

    S --> FF[Crear Tarea]
    S --> GG[Revisar Entregas]
    T --> HH[Asignar Calificaci√≥n]
    U --> II[Ver Estad√≠sticas]

    Y --> JJ[Video/Imagen/Audio]
    Y --> KK[Documentos PDF]
    AA --> LL[Historial de Calificaciones]

    style A fill:#e1f5fe
    style C fill:#fff3e0
    style I fill:#e8f5e8
    style J fill:#e3f2fd
    style K fill:#f3e5f5
```

### Flujo de Datos

```mermaid
sequenceDiagram
    participant F as Frontend
    participant A as AuthContext
    participant B as Backend API
    participant D as Database

    F->>A: Login Request
    A->>B: POST /api/login
    B->>D: Validate User
    D-->>B: User Data + Roles
    B-->>A: Token + User Info
    A-->>F: Store Token & User

    F->>A: Get User Courses
    A->>B: GET /api/profesor/cursos
    B->>D: Query Courses
    D-->>B: Courses Data
    B-->>A: Courses List
    A-->>F: Display Courses

    F->>A: Create Task
    A->>B: POST /api/tareas
    B->>D: Save Task
    D-->>B: Task Created
    B-->>A: Task Data
    A-->>F: Update UI
```

---

## üß™ TESTS Y CALIDAD

### Tests Backend

- **CursoTest**: 10 tests pasando (76 aserciones)
- **AutenticacionTest**: Validaci√≥n de login/logout
- **InscripcionTest**: Gesti√≥n de inscripciones
- **Cobertura**: CRUD completo para entidades principales

### Tests Frontend

- Funcionalidad manual verificada
- Componentes reactivos y responsivos
- Manejo de errores y estados de carga

---

## üöÄ DESPLIEGUE Y PRODUCCI√ìN

### Requisitos del Servidor

- PHP 8.2+
- MySQL 8.0+
- MongoDB 6.0+
- Node.js 18+
- Composer
- npm/yarn

### Variables de Entorno

```env
# Backend
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=mindschool
DB_USERNAME=root
DB_PASSWORD=

# MongoDB
MONGODB_URI=mongodb://localhost:27017
MONGODB_DATABASE=mindschool

# Frontend
VITE_API_URL=http://localhost:8000/api
```

---

## üìà M√âTRICAS Y MONITOREO

### KPIs del Sistema

- Usuarios activos por rol
- Cursos m√°s populares
- Tasa de finalizaci√≥n de cursos
- Tiempo promedio de entrega de tareas
- Satisfacci√≥n del usuario

### Logs y Monitoreo

- Laravel Logs para errores
- API response times
- User activity tracking
- Database performance metrics

---

_Este esquema representa el estado actual del sistema MindSchool, un LMS completo con funcionalidades para administradores, profesores y estudiantes, dise√±ado con arquitectura moderna y escalable._
